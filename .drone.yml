workspace:
  path: src

pipeline:
  build:
    image: webhippie/hugo:latest
    commands:
      - make build

  docker:
    image: plugins/docker:17.05
    pull: true
    secrets: [ docker_username, docker_password ]
    repo: umschlag/umschlag-docs
    tags: [ '${TAG}' ]
    when:
      event: tag
      branch: refs/tags/*

  docker:
    image: plugins/docker:17.05
    pull: true
    secrets: [ docker_username, docker_password ]
    repo: umschlag/umschlag-docs
    tags: [ 'latest' ]
    when:
      event: push
      branch: master

  gitter:
    image: plugins/gitter:1
    pull: true
    secrets: [ gitter_webhook ]
    when:
      local: false
      status: [ success, failure ]
